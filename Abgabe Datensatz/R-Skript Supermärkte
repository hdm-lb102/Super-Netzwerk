### SKRIPT SUPERMÄRKTE ###


## laden igraph, edge- und nodelist

library(igraph)
el <- read.csv("https://raw.githubusercontent.com/hdm-lb102/Super-Netzwerk/master/Abgabe%20Datensatz/Edgelist", header=T, as.is=T, sep = ",")
nodes <- read.csv("https://raw.githubusercontent.com/hdm-lb102/Super-Netzwerk/master/Abgabe%20Datensatz/Nodelist", header=T, as.is=T, sep = ",")
head(el)
head(nodes)

## igraph-Objekt aus edgelist erstellen

hties <-as.matrix(el)
super <- graph_from_data_frame(d=hties, vertices=nodes, directed=T)
plot(super)


## Anpassung der Knotengröße und Kanten
ds <- degree(super)
plot(super, vertex.size=ds)

E(super)$arrow.size <- .2
E(super)$color="grey"
plot(super, vertex.size=ds)

## Zusammenfassung der Kanten mit simplify
list.edge.attributes(super)
list.vertex.attributes(super)
edge.attributes(super)$weight

kanten <- simplify(super, edge.attr.comb = list(weight="sum"))
edge.attributes(kanten)$weight


## Zuweisung der Knoten-Farben (Supermarkt-Gruppen)

farben <- c("olivedrab1", "rosybrown1", "goldenrod1", "paleturquoise1", "khaki1")
V(super)$color <- farben[V(super)$zugehoerigkeitdermarke]
plot(super, vertex.size=ds)


## Zuweisung Layout, Schrift

plot(super, vertex.size=ds, layout=layout_with_fr, main="Gesamtnetzwerk Super", vertex.frame.color = "transparent", vertex.label.family = "Helvetica", vertex.label.color = "black")



## Teilnetzwerke pos. + neg. erstellen und nebeneinander legen

par(mfrow=c(1,2))
snegativ <- subgraph.edges(super, E(super)[relationship < "3"])
spositiv <- subgraph.edges(super, E(super)[relationship > "2"])
E(snegativ)$color <- "red"
plot(snegativ)
E(spositiv)$color <- "green"
plot(spositiv)
